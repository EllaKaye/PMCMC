## Some functions to implement SMC